+ ![image-20210317212229508](C:\Users\雨初\AppData\Roaming\Typora\typora-user-images\image-20210317212229508.png)

+ `date ""` 以 `+` 开头，后面跟格式

  ![image-20210317213006967](C:\Users\雨初\AppData\Roaming\Typora\typora-user-images\image-20210317213006967.png)

   ![image-20210317213033127](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210317213033127.png)

+ `wget` 参数

  ![image-20210317213147098](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210317213147098.png)

  `-p` 后面加上目录名表示下载到指定目录。 `-c` 可以断点续传。

+ 关机的方法

  ![image-20210317213225900](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210317213225900.png)

+ `ps` 不用加 `-` 。 `a` 表示显示所有进程， `u` 表示显示详细信息， `x` 表示没有控制终端的进程。

  ![image-20210318102858294](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318102858294.png)

### top

![image-20210318103618816](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318103618816.png)

这三个表示最近1分钟、5分钟、15分钟CPU的负载，最低为0，如果达到1说明队列是满的。如果达到5说明服务器随时有可能崩溃。

![image-20210318104219483](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318104219483.png)

总共315个进程，3个正在运行，312个正在休眠，无停止/僵尸进程。

![image-20210318104325744](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318104325744.png)

第三行表示CPU使用量，us表示占用量，id表示空闲量，1.3%正在使用，98.3%空闲。

第四行的内存使用看左边是Mib就是MB为单位，KiB就是KB为单位。

![image-20210318104749472](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318104749472.png)

pr和ni表示进程优先级，数字越低表示优先级越高。

+ `pidof 进程名` 可以查看某个特定服务进程的pid值。
+ `killall 服务名` 可以杀死一个服务对应的所有进程，或者 `systemctl stop` 也可以关闭掉这个服务。



## 第三节

### ifconfig

+ ![image-20210318110817516](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318110817516.png)

  网卡名称和IP地址

+ ![image-20210318110919000](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318110919000.png)

  MAC地址

+ ![image-20210318110949169](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318110949169.png)

  RX表示收到的数据包的大小，TX表示发送出去的数据包的大小。

### uname

+ `uname -a` 展示所有信息， `a` 是 `all` 的意思。

+ ![image-20210318111505891](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318111505891.png)

  系统名称 主机名称 内核版本 打包时间 系统时间 硬件名称 硬件平台 处理器类型 操作系统名

### uptime

+ ![image-20210318112117953](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318112117953.png)

  其实就是 `top` 的第一行。如果显示2user，但是只开了一个终端，其实桌面也算是一个。

### free

+ ![image-20210318112310221](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318112310221.png)

  free可以显示内存相关的信息，如果使用 `free -h` 可以让其带上单位，更人性话。

  ![image-20210318112813112](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318112813112.png)



### who

+ ![image-20210318112900762](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318112900762.png)

  `:0` 表示图形界面， `pts` 表示终端，如果有多个终端就有 `pts/1` `pts/2` 之类。

### last

+ `last` 用来查看所有系统的登陆记录，但是由于这些信息都是日志形式







![image-20210318112952529](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318112952529.png)

### history

+ `!数字` 可以重复执行某一条指令。

### sosreport

+ 打包错误信息

### cd

+ `cd - ` 是回到上一个目录

### tail&&head

+ 查看前n行或者后n行
+ 如果想要实时查看某个文件后面的内容，可以 `tail -f` 来实时刷新。

## tr

+ 替换文本

### wc

+ 统计文件里面有多少行，多少列，多少字节

### stat

+ 可以查看最后一次访问文件内容（ `access` ）、最后一次修改文件内容（ `modify` ）、最后一次更改文件 **属性信息** （ `change` ）时间。

  ![image-20210318145900319](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318145900319.png)

### cut

+ `cut -d : -f 1 /etc/passwd` 可以查看所有的用户信息

### diff

+ `-brief` 可以查看简要信息，看两个是否一样。 `-c` 可以列出哪里不一样，不一样的地方前面会加上 `!` 感叹号。

### touch

+ `touch -d` 可以修改文件修改时间，因此通过 `ls` 看到的修改时间是不准的。

  ![image-20210318151300243](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318151300243.png)

### mkdir

+ `mkdir -p` 可以递归生成目录，生成多级目录。

### cp

+ `cp -r` 可以递归复制，把一个目录复制过去。

### dd

+ `dd` 命令用于按照指定大小和个数的数据块来复制文件或转换文件。 `if` 是 `input file` ， `of` 是 `output file` 。 `bs` 是每个块的大小， `count` 是想要复制的块的个数。

  ![image-20210318152947428](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318152947428.png)

### tar

+ `tar -czvf etc.tar.gz /etc` 压缩， `-f` 表示指定目标文件名，后缀最好为 `.tar.gz`

  ` tar xzvf etc.tar.gz -C /root/etc` 解压。 `-C` 可以制定解压到的目录。

  ![image-20210318195045420](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318195045420.png)

### grep

+ `-n` 显示行号， `-v` 反选，仅列出没有关键词的行。

  ![image-20210318195605580](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318195605580.png)

### find

+ ![image-20210318200231730](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318200231730.png)

## 第四节

### 输入输出重定向

+ `>` 覆盖， `>>` 追加， `2>` 错误信息（覆盖）， `2>>` 错误信息（追加）， `&>>` 将标准输出和错误信息共同输出到文件（追加）

  ![image-20210318202616743](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318202616743.png)

+ 输入重定向可以把文件的内容传给命令， `<<` 可以指定输入的分界符。

  ![image-20210318202623790](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318202623790.png)

### 转义字符

+ 匹配

![image-20210318204732350](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318204732350.png)

+ `\$` ，另， `$$` 表示当前进程pid。

+ 双引号可以把整个字符串作为一个整体， `''` 两个单引号表示里面的全部转义。如果是 `""` ，则如果其中存在需要转义的字符，要进行转义。

+ ```
  `命令`
  ```

  可以把命令的输出当输入，如

  ```
  PRICE=`命令`
  ```

### 重要的环境变量

+ `alias zyc="rm -rf"` 可以给命令起别名
+ `unalias zyc` 可以取消 `zyc` 这个命令的别名。
+ `alias` 的有效期直到下一次服务器开机，重启之后失效。
+ ![image-20210318211503719](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318211503719.png)

+ 想查看某个外部命令存放的位置，可以用 `whereis` ， `whereis 命令` ，可以显示出这个外部命令存放的位置。

  ![image-20210318211839087](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318211839087.png)

+ ![image-20210318212321820](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318212321820.png)

  `$HOME` 是家目录， `$HISTSIZE` 是历史记录保存数目， `$LANG` 是当前编码。

+ `$RANDOM` 是一个随机数，每次取得到的值都不一样， `$PS1` 是终端显示的提示符

  ![image-20210318212830923](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318212830923.png)

  ![image-20210318212821071](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318212821071.png)

+ ![image-20210318213119668](https://raw.githubusercontent.com/smallzhong/new-picgo-pic-bed/main/image-20210318213119668.png)

+ `export` 可以将变量提升到全局变量。普通用户也可以提升全局变量。

  ![image-20210319204253238](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210319204253238.png)

### 文本编辑

+ `dd` 删除一行
+ `p` 把之前删除 （ `dd` ）或者复制 `yy` 过的数据粘贴到光标后面。
+ `u` 是 `undo` ，撤销操作。
+ 可以分别使用 `a`、`i`、`o` 三个键从命令模式切换到输入模式。其中，`a` 键 与 `i` 键分别是在光标后面一位和光标当前位置切换到输入模式，而 `o` 键则是在光标的下面再 创建一个空行

### 脚本

+ 使用

  ```bash
  A = $(ls)
  A = `ls`
  ```

  得到的结果是一样的， 都是后面的先执行完毕之后把结果返回给前面的变量。
  
+ 写 `bash` 脚本的时候运算表达式中间不可以加空格

### 计划任务

+  `at` 设定一个当前有效的计划任务，输完之后按 `ctrl + d` 退出。

+ `at -l` 可以看到当前有哪些计划任务

  ![image-20210320135705681](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320135705681.png)

+ `at -c 编号` 可以看到当前的计划任务（具体的命令）

  ![image-20210320135725229](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320135725229.png)

+ 如果想要删除当前的计划任务，先 `at -l` 列出当前的计划任务，然后 `atrm 序号` 删除这一条计划任务，就可以除去这一条计划任务。 `at -r` 的效果和 `atrm` 是一样的，但是 `atrm` 比较直观
+ `crond` 是一个服务的名称， `crontab` 是一个配置工具
  + `分 时 日 月 星期 命令` 。如果是空位的话要用 `*` 做占位。
  + 计划任务不像 `at` ，关机后还是会留存，一直存在。
  + `crontab -e` 是编辑计划任务
  + `-u` 是制定编辑某个人的计划任务
  + 在 `rhel` 中，计划任务中的命令要使用绝对路径来写
  + 如果前面的都是 `*` ，说明都是1，会每一分钟重启
  + 日期和星期不要同时设置，因为并不能知道某个日期到底是星期几。
  + `* 2 * * * /usr/sbin/reboot` 表示每天凌晨2点，而 `* */2 * * * /usr/sbin/reboot` 表示每两个小时
  + `10,30 5 * * * /usr/sbin/reboot` 表示每天5点的10，30分进行
  + 可以进行多个命令，命令中间使用 `;` 分号间隔。
+ `crontab -l` 可以查看当前的计划任务。
+ `crontab -l -u 用户名` 可以查看特定用户的计划任务
+ 如果想要设定多条计划任务，只要分开多行写 `crontab` 就可以。

### 用户身份

+  `useradd -u` 可以指定用户的 `uid` 。
+ `groupadd` 可以添加用户组 `usermod -G` 可以变更用户所在的组
+ `usermod -u` 可以修改用户的 `uid` 。
+ `passwd` 可以修改用户的密码， `passwd linuxprobe` 可以修改 `linuxprobe` 用户的密码
+ `userdel zhangsan` 可以删除 `zhangsan` 这个账户，但是删除之后其家目录还在。如果想要同时删除其家目录下的东西，可以加上 `-r` 参数， `userdel -r` 递归删除掉用户信息以及用户所对应的文件。一般来讲不推荐加上 `-r` 参数，先删除用户的信息，再手动删除用户的数据，确认一下里面没有重要的数据。

### 文件权限与归属

+ ![image-20210320151028313](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320151028313.png)
+ 所有者所有组其他人，而 `root` 用户不受现治。

## 第七节课

### 文件的特殊权限

+ `SUID` 执行者临时获取命令的所有的权限，比如说普通用户是没有 `/etc/shadow` 文件的权限的，但是使用 `passwd` 命令可以修改密码，修改 `/etc/shadow` 中存放的密码。原因就是 `suid` 

  ![image-20210320160328296](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320160328296.png)

  这个 `s` 表示可以让执行者临时获取 `root` 的权限

+ `chmod +权限 文件` 设置文件权限

  + `chmod +R g+s` ， `-R` 是递归整个文件夹， `-f` 是强制
  + `chmod +R g+s` 设置 `SGID` ， `chmod +R u+s` 设置 `SUID` ， `chmod +R o+t` 设置 `SBIT` 。
  + 如果我们给一个目录设置 `sgid` 权限，那么，这个文件夹里面创建的任何文件都将会归属于**该目录的所属组**，而**不再是自己的基本用户组**。

+ 如果给单独一个文件设置 `SUID` ，可以让程序的执行者临时获取程序所有组的权限，不过这个很少用到，一般都是给一个目录加上 `SUID` 权限。

+ `rwxrwxrwx`

  + 所有者：（前三位）SUID：如果原先所有者有 `x` 权限，设置了 `SUID` 之后变成 `rws` ，如果原先所有者是 `rw-` ，没有 `x` 权限，那么设置了 `SUID` 之后变成 `rwS` ，是大写的 `S` 。

  + 所有组：SGID：（中三位）如果原先所有组有 `x` 权限，设置了 `SGID` 之后变成 `rws` ，如果原先是 `rw-` ，没有 `x` 权限，那么设置了 `SUID` 之后变成 `rwS` ，是大写的 `S` 。

  + 其他人：（后三位）SBIT：如果如果原先其他人有 `x` 权限，设置了 `SBIT` 之后变成 `rwt` ，如果原先是 `rw-` ，没有 `x` 权限，那么设置了 `SBIT` 之后变成 `rwT` ，是大写的 `T` 。

  + `SUID=4` ， `SGID=2` ，`SBIT=1` ，如果有这几个位的话就在前面加上，比如 `rwsrw-r-T` 就是 `5764` 。原来是 `764` ，`SUID+SBIT=5` ，加起来是 `5764` 

  + ![image-20210320173325915](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320173325915.png)

    可以这样快速设置权限

+ `chown` 修改文件属性信息，修改所有者和所有组

  ![image-20210320174559746](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320174559746.png)

+ `chattr +i linuxprobe` 可以设置隐藏权限，给linuxprobe加上i的隐藏权限， `lsattr 文件名` 可以查看某个文件的隐藏权限。

+ `i` 是禁止修改， `a` 是只能追加不能修改。如果发现一个文件没法删除可以使用 `lsattr 文件名` 查看其隐藏权限，然后全部取消掉，这样就可以删除了。这个权限有点鸡肋，因为入侵者也可以进行相应的 `chattr` 操作。

#### setfacl

+ 文件访问控制列表 `set file access control list`

+ `-m` 表示修改权限， `-R` 表示修改一个目录的权限

+ `setfacl -Rm u:zhangsan:rwx /home/test` 。 `u` 是设置用户， `g` 是设置用户组

+ 在设置了一个文件或者文件夹的 `acl` 信息之后， `ls -l` 显示的最后一个属性会从 `-` 变成 `+` 。

  ![image-20210320192024055](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320192024055.png)

+ `getfacl` 可以查看一个文件上设置的 `acl` 信息。

+ `setfacl -b` 可以删除一个目录/文件的 `acl` 属性。

### su

+ `su 用户名` 和 `su - 用户名` 的区别是加上 `-` 的是 **完全切换到另一个用户下** ，环境变量也会切换。切换用户的时候最好使用 `su - 用户名` 。

+ `vim /etc/sudoers` 可以修改 `sudoers` ，或者 `visudo` 也可以，但是这样的话用的是 `vi` 编辑器，没有代码高亮。

+ ![image-20210320193447346](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320193447346.png)

  第一个 `ALL` 是指允许使用的主机

  ![image-20210320193524780](https://cdn.jsdelivr.net/gh/smallzhong/new-picgo-pic-bed@master/image-20210320193524780.png)

  可执行命令的列表必须使用绝对路径，如 `/usr/sbin/reboot` 。