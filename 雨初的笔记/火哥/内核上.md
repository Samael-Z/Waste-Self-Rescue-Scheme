# 句柄表

## 全局句柄表

+ 句柄其实就是句柄表中这个数组的一个下标

+ 全局句柄表可能有1级、2级、3级。主要看最后一个数是0，1，2中的哪个数。如果是0则是一级。

+ 全局句柄表的地址可以通过一个未导出的变量 `PspCidTable` 获得

  ![image-20211026195422802](https://cdn.jsdelivr.net/gh/smallzhong/new_new_picgo_picbed@main/image-20211026195422802.png)

+ 在找到全局句柄表的地址后可以通过 `dt _HANDLE_TABLE 地址` 来查看全局句柄表的信息

  ![image-20211026195508353](https://cdn.jsdelivr.net/gh/smallzhong/new_new_picgo_picbed@main/image-20211026195508353.png)

  这里可以看到这个全局句柄表是两层的