## 问题描述

Windows操作系统的本地PC，通过RDP协议（如MSTSC方式）远程桌面连接Windows弹性云服务器报错，报错显示：您的凭据无法工作，之前用于连接到云主机的凭据无法工作，请输入新凭据。

## 处理方法

请按照以下步骤依次排查，并在每一个步骤执行完后重新连接Windows云服务器验证问题是否解决，如未生效请继续执行下一步骤。

步骤一：修改网络访问策略

步骤二：修改凭据分配

步骤三：设置本地主机的凭据

步骤四：关闭云服务器密码保护共享

## 步骤一：修改网络访问策略

使用管理控制台VNC方式登录云服务器。

打开“开始 > 运行”，输入“gpedit.msc”，打开“本地组策略编辑器”。

图1 gpedit.msc

点击放大

选择“计算机配置 < Windows设置 < 安全设置 < 本地策略 < 安全选项”，打开“网络访问：本地帐户的共享和安全模型”。

图2 打开网络访问策略

点击放大

选择“经典 - 对本地用户进行身份验证，不改变其本来身份”，单击“确定”。

图3 修改网络访问策略



## 步骤二：修改凭据分配

使用管理控制台VNC方式登录云服务器。

打开“开始 > 运行”，输入“gpedit.msc”，打开“本地组策略编辑器”。

选择“计算机配置 < 管理模板 < 系统”，打开“凭据分配”。

图4 打开网络访问策略

点击放大

双击打开“允许分配保存的凭据用于仅NTLM服务器身份验证”，单击“确定”。

图5 允许分配保存的凭据用于仅NTLM服务器身份验证

点击放大

选择“已启用” 在“显示”里面输入TERMSRV/*。TERMSRV/* 表示运行在所有计算机上的终端服务器。

图6 配置为已启用

点击放大

刷新组策略，让设置生效。

打开“开始 > 运行”输入gpupdate /force，更新组策略。

图7 更新组策略



## 步骤三：设置本地主机的凭据


打开本地主机的控制面板，选择“凭据管理器 > 管理Windows凭据”。

图8 凭据管理器

点击放大

看Windows凭据下是否有当前登录的云服务器凭据，如果没有，添加一条凭据。


图9 添加凭据
点击放大

## 步骤四：关闭云服务器密码保护共享

登录云服务器。

打开左下角的“开始”菜单，选择“控制面板 > 所有控制面板项 > 网络和共享中心 > 更改高级共享配置。


在“密码保护的共享”页签下选择“关闭密码保护共享”。

图10 关闭密码保护共享

点击放大

单击“保存修改”。
